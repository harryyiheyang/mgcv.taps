% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/smoothed_linearity.R
\name{smoothed_linearity}
\alias{smoothed_linearity}
\title{Generate a Smoothed Linearity Basis Matrix}
\usage{
smoothed_linearity(x, a)
}
\arguments{
\item{x}{A numeric vector representing the covariate values.}

\item{a}{A numeric scalar controlling the magnitude of the deviation from linearity.}
}
\value{
A numeric matrix where columns represent:
  \itemize{
    \item `Intercept`: A column of ones.
    \item `x`: The original covariate.
    \item `Nonlinear term`: The added nonlinear Gaussian-like bump.
  }
}
\description{
This function constructs a design matrix for testing linearity, incorporating a smooth deviation
using a Gaussian-like function centered at `0.5` after rescaling `x` to `[0,1]`.
}
\details{
This function rescales `x` to `[0,1]`, applies a **Gaussian perturbation** centered at `0.5`,
and then rescales the transformation back to the original range.
The transformed function is:
\deqn{ f(x) = 4x + a \exp(-16(x - 0.5)^2) }
where `a` controls the magnitude of the deviation.
}
\examples{
x <- seq(0, 10, length.out=100)
smoothed_linearity(x, a=2)

}
