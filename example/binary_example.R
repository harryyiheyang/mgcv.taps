devtools::load_all()
library(mgcv)
a=0.05
n=10000
X=MASS::mvrnorm(n,rep(0,4),matrix(0.25,4,4)+0.75*diag(4))
x1=qbeta(pnorm(X[,1]),1.5,1.5)
x2=qbeta(pnorm(X[,2]),1.5,1.5)
x3=qbeta(pnorm(X[,3]),1.5,1.5)
x4=qbeta(pnorm(X[,4]),1.5,1.5)
if(a!=0){
X1_design=smoothed_linearity_discontinuity(x1,list(0.5,a))[,-1]
f1=c(X1_design%*%c(4,4,0))
}else{
X1_design=linearity_discontinuity(x1,0.5)[,-1]
f1=c(X1_design%*%c(4,4,0))
}
t2=2*pi*x2
f2=0.4*sin(t2)+0.8*cos(t2)+1.2*sin(t2)^2+1.6*cos(t2)^3+2*sin(t2)^3
t3=2*(x3-0.5)
f3=3*sin(3*t3)+6*exp(-36*t3^2)
f4=0*x4
eta=f1+f2+f3
y=rbinom(n,1,pnorm(eta/2-5/2))
fit=gam(y~s(x1,bs="AMatern",k=10,m=100,xt=list(getA=linearity_discontinuity,para=0.5))+s(x2,bs="cr",k=10)+s(x3,bs="cr",k=15)+s(x4,bs="cr",k=10),method="REML",family=binomial(link="probit"))
taps_wald_test(fit,test.component=1)
taps_score_test(fit,test.component=1,large_n=F)
taps_score_test(fit,test.component=1,large_n=T)
test.component=1;null.tol=1e-10
